<!-- main content -->
<div class="p-4 bg-white rounded-3 w-100">

    <!-- Loading Skeleton -->
    @if (loading) {
    <app-loading></app-loading>
    } @else {
    <div class="d-flex justify-content-between mb-4">
        <form action="" method="get" class="d-flex w-50">
            <input type="text" class="form-control w-75" placeholder="nhập tên hoặc email">
            <button class="btn btn-main">
                <i class="fa-brands fa-searchengin"></i>
            </button>
        </form>
        <button class="btn btn-main" routerLink="/dashboard/users/add">
            <i class="fa-solid fa-plus"></i>
            Thêm
        </button>
    </div>

    <div class="table-responsive">
        <table class="table table-hover table-bordered">
            <thead>
                <tr>
                    <th scope="col">Id</th>
                    <th scope="col">Họ và tên</th>
                    <th scope="col">Email</th>
                    <th scope="col">Trạng thái</th>
                    <th scope="col">Thao tác</th>
                </tr>
            </thead>
            <tbody>
                @if (users.data.length === 0) {
                <tr>
                    <td colspan="5" class="text-center">Không có dữ liệu</td>
                </tr>
                } @else {
                @for (user of users.data; track user.id) {
                <tr>
                    <th scope="row">{{user.id}}</th>
                    <td>{{user.name}}</td>
                    <td>{{user.email}}</td>
                    <td>
                        <span [class]="user.is_active ? 'badge bg-success' : 'badge bg-danger'">
                            {{user.is_active ? 'Hoạt động' : 'Không hoạt động'}}
                        </span>
                    </td>
                    <td>
                        <a class="btn btn-success btn-sm m-1" (click)="onDetail(user.id)">Xem</a>
                        <a [routerLink]="['/dashboard/users/edit', user.id]" class="btn btn-warning btn-sm m-1">
                            <i class="fas fa-edit"></i> Sửa
                        </a>
                        <button class="btn btn-danger btn-sm m-1" (click)="deleteUser(user.id)">Xóa</button>
                    </td>
                </tr>
                }
                }
            </tbody>
        </table>
    </div>
    }
    <app-pagination [currentPage]="users.current_page" [totalPages]="users.last_page" [disabled]="disablePagination"
        (pageChange)="getCurrentPage($event)"></app-pagination>
</div>

<app-modal *ngIf="selectedUser" [isVisible]="showModal" [title]="'Thông tin người dùng'" [size]="'lg'"
    (closeModal)="onClose()">
    <!-- (closeModal)="closeModal()" -->
    <!-- Template cho phần body của modal -->
    <ng-template #modalBody>
        <div class="user-info row justify-content-evenly">
            <div class="col-5 p-4">
                <div class="info-row">
                    <div class="info-label">ID: {{ selectedUser.id || 'N/A' }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Họ và tên: {{ selectedUser.name || 'N/A' }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Email: {{ selectedUser.email || 'N/A' }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Vai trò: {{ selectedUser.role === 'admin' ? 'Quản trị viên' : 'Người dùng'
                        }}
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-label">Trạng thái:
                        <span [class]="selectedUser.is_active ? 'badge bg-success' : 'badge bg-danger'">
                            {{ selectedUser.is_active ? 'Hoạt động' : 'Không hoạt động' }}
                        </span>
                    </div>
                </div>
            </div>
            <div class="col-6 p-4">
                <div class="info-row">
                    <div class="info-label">Ngày tạo:</div>
                    <div class="info-value">{{ selectedUser.created_at }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Ngày cập nhật:</div>
                    <div class="info-value">{{ selectedUser.updated_at }}</div>
                </div>
            </div>


        </div>
    </ng-template>
</app-modal>